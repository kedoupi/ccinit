## 更新文档

自动管理多语言项目的代码文档注释，保持高质量文档标准。

### 用法

```bash
# 自动检测语言并更新
"请为缺少文档的类和函数添加注释，并更新不符合标准的注释"

# 指定特定语言
/update-doc --lang python
"请更新 Python 文件中的文档字符串，符合 PEP 257 标准"

# 指定特定目录
"请为 src/components/ 下的函数添加 JSDoc 注释"

# 不添加 Claude 标记
/update-doc --marker false
"改进现有文档注释，不添加 Claude 标记"
```

### Options

- `--lang <language>` : 指定编程语言 (python, javascript, typescript, dart, go, rust)
- `--marker <true|false>` : 是否添加 Claude 标记 (默认: true)

### 执行流程

#### 1. 目标元素优先级

1. 🔴 **最高优先级**: 没有文档注释的元素（0 行注释）
2. 🟡 **次优先级**: 不符合标准的元素（少于 30 字符或缺少必需元素）
3. 🟢 **验证目标**: 没有 Claude 标记的现有注释

**目标元素**:
- 类定义
- 函数/方法
- 模块 (Python, Go)
- 枚举
- 接口 (TypeScript, Go)

#### 2. 各语言文档规范

**Python (PEP 257)**:
```python
def calculate_total(items: List[Item]) -> float:
    """计算商品列表的总金额。

    将每个商品的价格和数量相乘，返回包含税费的总额。
    空列表返回 0.0。

    Args:
        items: 要计算的商品列表

    Returns:
        包含税费的总金额

    Generated by Claude 🤖
    """
```

**JavaScript/TypeScript (JSDoc)**:
```javascript
/**
 * 显示用户资料的组件。
 *
 * 显示头像图片、用户名和状态信息，
 * 点击时导航到资料详情页面。
 *
 * @param {Object} props - 组件属性
 * @param {string} props.userId - 用户 ID
 * @param {boolean} [props.showStatus=true] - 状态显示标志
 * @returns {JSX.Element} 渲染的组件
 *
 * @generated by Claude 🤖
 */
```

**Dart (DartDoc)**:
```dart
/// 显示用户资料的 Widget。
///
/// 垂直排列头像图片、用户名和状态信息，
/// 点击时导航到资料详情页面。
///
/// Generated by Claude 🤖
class UserProfileWidget extends StatelessWidget {
```

**Go**:
```go
// CalculateTotal 计算商品列表的总金额。
//
// 将每个商品的价格和数量相乘，返回包含税费的总额。
// 空切片返回 0.0。
//
// Generated by Claude 🤖
func CalculateTotal(items []Item) float64 {
```

**Rust**:
```rust
/// 计算商品列表的总金额。
///
/// 将每个商品的价格和数量相乘，返回包含税费的总额。
/// 空向量返回 0.0。
///
/// Generated by Claude 🤖
pub fn calculate_total(items: &[Item]) -> f64 {
```

#### 3. 内容保留规则

1. **现有注释符合标准**: 保持原样（不添加新注释）
2. **现有注释不符合标准**: 完全替换（不重复）
3. **没有现有注释**: 添加新注释

**重要信息保留**:
- URL 和链接: `See also:`, `@see`, `References:` 等
- TODO 注释: `TODO:`, `FIXME:`, `XXX:` 格式
- 注意事项: `Note:`, `Warning:`, `Important:` 等
- 示例: `Example:`, `Usage:` 等
- 现有参数和返回值描述

### 质量检查清单

- ✅ **字符数量**: 严格遵守摘要 30-60 字符，详细说明 50-200 字符
- ✅ **必需元素**: 始终包含摘要、详细描述和 Claude 标记
- ✅ **完整性**: 描述作用、使用上下文和注意事项
- ✅ **语言规范**: 符合各语言官方风格指南
- ✅ **准确性**: 分析实现并仅包含基于事实的描述

### 注意事项

**🔴 严格禁止**:
- ❌ 文档注释以外的代码更改
- ❌ 对实现细节的推测（仅事实描述）
- ❌ 违反语言规范的格式
- ❌ 删除或修改现有类型注解
- ❌ 与现有注释重复
- ❌ 测试文件中低于字符数标准的注释

### 与 Claude 协作

```bash
# 分析整个项目（自动语言检测）
find . -type f \( -name "*.py" -o -name "*.js" -o -name "*.ts" -o -name "*.dart" \)
/update-doc
"更新此项目的文档注释，遵循语言特定的最佳实践"

# 明确指定英文文档
/update-doc --lang python
"更新 Python 文档字符串，遵循 PEP 257 标准"

# 不添加标记运行
/update-doc --marker false
"改进现有文档注释，不添加 Claude 标记"
```