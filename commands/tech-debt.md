## Tech Debt

### 核心作用
系统梳理项目中的技术债务（代码质量、依赖、架构、安全、测试等），评估影响与修复成本，并制定排序清单与实施计划。

### 快速用法
```bash
"请扫描项目技术债：涵盖代码可维护性、依赖健康、安全风险、测试覆盖，并按优先级给出计划"
```

可先收集辅助信息：
```bash
rg "TODO|FIXME|HACK" --glob '!node_modules'
find src -type f -name '*.ts' -exec wc -l {} + | sort -rn | head -10
npm outdated
```

### 分析维度
1. **代码质量**：长函数、重复逻辑、圈复杂度、缺失异常处理。
2. **依赖管理**：过期版本、已知 CVE、未使用依赖、锁文件不一致。
3. **架构/分层**：耦合度、循环依赖、违背模块边界、缺少文档。
4. **安全**：硬编码凭据、弱算法、日志泄露、缺失安全头/校验。
5. **测试/流程**：覆盖率、Flaky、缺失自动化、CI 门禁不足。
6. **性能/运维**：慢查询、缺失监控、配置漂移、资源浪费。

### 输出结构（示例）
```
技术债务报告
━━━━━━━━━━━━━━━━━━━━━━
总览
- 高风险：3 项
- 中风险：5 项
- 低风险：6 项

优先级清单（示例）
1. 🔴 Security - 明文存储秘钥（影响：高 / 工作量：中 / 建议：立即修复）
2. 🟡 Architecture - UserService 结构过于庞大（影响：中 / 工作量：大 / 建议：拆分计划）
3. 🟢 Testing - 缺少支付流程 E2E 测试（影响：中 / 工作量：中 / 建议：两周内补齐）

分阶段计划
- Sprint 1：安全整改、依赖升级
- Sprint 2：模块拆分、补充关键测试
- Sprint 3：完善监控与文档
```

### 与 Claude 协作
- 在执行 `/tech-debt` 前提供 `git ls-tree`、`rg`、`dependency` 等输出，便于精准定位。
- 可要求 Claude 生成“影响 × 努力 × 风险”矩阵或甘特图。
- 结合 `/plan` 制定路线图，或用 `/task` 创建后续改进任务。

### 使用建议
- 优先处理高影响、高概率引发事故的项目，其次是可增强团队效率的项。
- 建议定期（如每季度）运行一次，形成技术债台账。
- 修复前确认业务节奏，必要时与产品/项目管理同步安排。
